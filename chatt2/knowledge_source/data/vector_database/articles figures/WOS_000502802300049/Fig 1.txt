Fig. 1. Overview of MetaBGC. (A) The first step of MetaBGC is the development of high-performance spHMMs that are  specific  for  a  given  class  of  BGCs  (MetaBGC-Build).  Homologs  of  the  protein  family  of  interest  are  aligned,  and  the  alignment is segmented into 30 amino acid fragments with a ten amino acid window shift. spHMMs are built using the  segmented alignments, which are then evaluated using synthetic metagenomes composed of a predominantly negative  background and spiked with positive BGCs. spHMMs with F1 scores >=0.5 form the basis of MetaBGC-Identify, while  ones  with  F1  scores  <0.5  are  excluded.  (B)  The  remaining  three  steps  of  MetaBGC:  (1)  MetaBGC-identify  detects  biosynthetic reads from complex metagenomic datasets of the human microbiome using spHMMs (as described in A);  (2)  Unique  biosynthetic  reads  are  then  quantified  in  all  samples  (MetaBGC-Quantify),  and  an  abundance  profile  is  generated  for  each  read;  and  (3)  Unique  biosynthetic  reads  are  finally  clustered  based  on  their  abundance  profiles  (MetaBGC-Cluster) to produce read “bins” that originate from specific BGCs. For example, biosynthetic reads colored  in red or blue are detected from ten metagenomic samples, quantified in the same samples, and finally clustered to  produce two distinct bins (a red one and a blue one) that originate from bgc1 or bgc2, respectively. Non-biosynthetic  reads are colored in grey.   