Fig. 2. Using MetaBGC to detect TII-PKS BGCs in synthetic metagenomic samples. (A) A typical organization  of  a  TII-PKS  BGC,  composed  of  genes  encoding  for  two  ketosynthases  (KSα  and  KSβ),  responsible  for  the  elongation and chain-length determination of the growing polyketide chain, respectively, a thiolation domain (T),  on which the growing chain is attached, and at least one type of cyclase/aromatase (Cyc), responsible for the  cyclization of the linear chain. Through additional tailoring reactions, more elaborate structures are formed, such  as the clinically used antibiotic tetracycline. (B) Four types of cyclases/aromatases are specifically found in TII- PKS  BGCs,  and  are  chosen  as  protein  families  for  MetaBGC.  For  each  of  the  four  protein  families,  segmented  alignments corresponding to 30 amino acid intervals are used to build spHMMs. Each spHMM is then evaluated  using  synthetic  metagenomes  designed  to  simulate  several  expected  compositions  in  human  microbiome  samples  (synthetic  dataset  1).  The  F1  score  (Y  axis)  of  each  spHMM  /  interval  (X  axis)  is  calculated,  which  is  indicative of its accuracy (considering both precision and recall). Values shown represent the maximum F1 score  after testing various spHMM score thresholds (fig. S8). Note that some spHMMs have very low F1 scores, while  others have high ones (only spHMMs with F1 scores >=0.5 were included in MetaBGC-Identify). The F1 score of  each  unsegmented  cyclase  pHMM  is  shown  in  green.  (C)  A  stacked  bar  graph  showing  11  bins  (>50  unique  biosynthetic reads each) that MetaBGC produced when applied to the 140 synthetic metagenomes simulated in  this study (synthetic dataset 1). Colors indicate the types of cyclases that the biosynthetic reads belong to within  each  bin,  and  blue  indicates  false-positive  reads  (FP).  The  heat  map  on  top  indicates  the  number  of  BGCs  represented per bin, and the number of genomes that these BGCs originate from. Most bins represent a single  BGC, and when two BGCs are represented by the same bin, they are expectedly derived from the same spiked  genome. Results from synthetic dataset 2 can be found in figs. S12 to S14.   